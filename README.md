# Хакатон Практикум 23 ноября - 8 декабря 2023. Команда 7.

---

## Команда DS

- Кудряева Анна  
- Коба Никита  
- Коновальцев Сергей

---

## Задача

### Заказчик 
ООО "ПРОСЕПТ" - российская производственная компания, специализирующаяся на выпуске профессиональной химии.

Сайт: [prosept.ru](https://prosept.ru/)

### Описание проекта

Заказчик производит несколько сотен различных товаров бытовой и промышленной химии, а затем продает эти товары через дилеров. Дилеры, в свою очередь, занимаются розничной продажей товаров в крупных сетях магазинов и на онлайн площадках.

Для оценки ситуации, управления ценами и бизнесом в целом, заказчик периодически собирает информацию о том, как дилеры продают их товар. Для этого они парсят сайты дилеров, а за тем сопоставляют товары и цены.
Зачастую описание товаров на сайтах дилеров отличается от того описания, что дает заказчик. Например, могут добавляться новые слова ("универсальный", "эффективный") объем (0,6 л -> 600 мл). Поэтому сопоставление товаров с товарами производителя делается вручную.

**Цель этого проекта** - разработка решения, которое автоматизирует процесс сопоставления товаров. Основная идея - передать несколько товаров заказчика, которые с наибольшей вероятностью соответствуют размечаемому товару дилера. Предлагается реализовать это решение как онлайн-сервис, открываемый в веб-браузере. Выбор наиболее вероятных подсказок делается методами машинного обучения.

---

## Решение

Сопоставление названий дилеров с названиями товаров заказчика делалось по методу ближайших соседей и расчетом косинусного расстояния между полученными многомерными векторами. В дальнейшем проводилось обучение классификатора с использованием CatBoost, расчет метрик и формирование финального датасета с результатами.

- Предобработка данных
- Вычисление косинусного расстояния
- Объединение данных для последующего машинного обучения
- Машинное обучение с расчетом метрик 
- Формирование финального датасета

---

## Итог

Получено необходимое сопоставление товара дилера с товарами заказчика. На выходе обучения формируется итоговый датасет с сопоставленными товарами и дополнительным полем, в котором представлена вероятность соответствия товара поставщика товару дилера, которая служит подсказкой при сопоставлении.

---

## Технологии

- Векторизация: `TfidfVectorizer`
- Определение ближайших соседей: `NearestNeighbors`
- Машинное обучение: `CatBoostClassifier`
- Метрики: `f1_score`, `accuracy_score`, `roc_auc_score`, `roc_curve`, `precision_score`, `recall_score`, `accuracy@5`, `recall@5`, `mrr@5`

---

## Метрики на валидационной выборке, полученные с помощью модели CatBoostClassifier

- accuracy@5  --> 0.974860 
- recall@5    --> 0.974860
- mrr@5       --> 0.887663

**Комментарий**: Обращаем внимание, что мы не удаляли товары, для которых нельзя было сопоставить по id поставщика и дилера, а попытались также с помощью машинного обучения сопоставить их.
